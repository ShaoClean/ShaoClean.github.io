---
icon: css
date: 2023-03-19
category:
    - 前端
    - CSS
tag:
    - 属性计算过程
    - 学习笔记
---

# CSS 属性计算过程

CSS 属性的计算过程分为四个步骤

1.确定声明值

2.解决层叠冲突

3.使用继承

4.使用默认值

## 确定声明值

确认声明值就是我们开发者写下的 CSS 样式，比如说：

```css
p {
	color: red;
}
```

那么此时，我们就知道了声明值就是这个`color:red`了。

但是如果存在样式规则的冲突该怎么办呢？在开发的过程中肯定会存在这个问题的，有可能不是当前的属性值影响到了最终的样式效果，而是在其它地方对其属性的修改产生了效果。

所以存在一个`层叠冲突`的问题。

## 解决层叠冲突

解决层叠冲突的流程一般经历三个：

-   比较源的重要性

-   比较优先级

-   比较次序

### 比较源的重要性

在此之间，需要知道存在三种样式表：

-   作者样式表
    可以理解为开发人员写的样式

-   用户样式表
    用户在浏览器中设置中导入的样式。是由用户自定义的样式表，用来覆盖网页的默认样式或作者样式。用户可以根据自己的喜好和需求，修改网页的字体、颜色、大小、背景等样式，以达到更好的阅读和使用体验。

-   用户代理样式表
    浏览器默认样式。是由浏览器厂商提供的默认样式表，用来定义 HTML 元素的默认样式，比如字体、颜色、大小等。不同的浏览器厂商可能会提供不同的默认样式，但大多数情况下，它们都是类似的。

他们三者的影响效果：作者样式表>用户样式表>用户代理样式表。按照此规则来确认使用哪种样式效果。

如果在同一个源中存在样式声明冲突怎么办？接下来就需要比较优先级了。

### 比较优先级

在下面这一段 css 代码中，源的重要性是相同的，都是属于作者样式。但是这两段代码存在规则冲突的问题，就需要比较它们选择器的优先级了。

```css
.test h1 {
	font-size: 50px;
}

h1 {
	font-size: 20px;
}
```

#### 选择器的优先级

> 优先级就是分配给指定的 CSS 声明的一个权重，它由 匹配的选择器中的 每一种选择器类型的 数值 决定。

> 而当优先级与多个 CSS 声明中任意一个声明的优先级相等的时候，CSS 中最后的那个声明将会被应用到元素上。

> 当同一个元素有多个声明的时候，优先级才会有意义。因为每一个直接作用于元素的 CSS 规则总是会接管/覆盖（take over）该元素从祖先元素继承而来的规则。

下面列出的选择器权重是递增的：

1.类型选择器（如,`h1`）和伪元素（如,`::before`）

2.类选择器（如，`.class1`）、属性选择器（如，`[type="xxx"]`）、伪类（如，`:hover`）

3.ID 选择器（如，`#id`）

还存在两种特殊的情况：

-   行内样式：`style`的优先级会大于上面说的三种

-   规则中加上了`!important`的会大于所有权重

回到一开始的代码，类选择器的优先级大于属性选择的优先级，所以`font-size: 50px;`为确认的样式。

### 比较顺序

一般来说经历上面两个步骤就能确定样式规则，但是存在源相同、选择器的优先级相同的情况。

此时只需要比较出现的顺序就行了，后面出现的规则会覆盖前面出现的规则。

```css
h1 {
	font-size: 50px;
}

h1 {
	font-size: 20px;
}
```

此时的`font-size: 20px;`覆盖前面的`font-size: 50px;`，最终确定为`20px`

## 使用继承

解决完层叠冲突后，如果遇到没有声明的属性，那么就会使用默认值了吗？

在使用默认值之前，还会判断父元素中是否有相关的声明，如果有，则将该声明继承过来。

```css
div {
	color: red;
}
```

```html
<div>
	<p>Lorem ipsum dolor sit amet.</p>
</div>
```

在上面的代码中，针对 div 设置了 color 属性值为红色，而针对 p 元素我们没有声明任何的属性，但是由于 color 是可以继承的，因此 p 元素从最近的 div 身上继承到了 color 属性的值。

需要注意的是，继承的是最近的父元素。

对于哪些样式可以继承，就需要在使用的时候看文档了。

## 使用默认值

最后，如果属性不能通过继承得来，就只能使用浏览器默认的样式了。

一个 HTML 元素要在浏览器中渲染出来，必须具备所有的 CSS 属性值，但是绝大部分我们是不会去设置的，用户代理样式表里面也不会去设置，也无法从继承拿到，因此最终都是用默认值。
